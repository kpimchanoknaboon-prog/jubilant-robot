<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåå CS Work Agent Dashboard</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Grotesk', sans-serif;
            background: linear-gradient(135deg, #1e1b4b 0%, #7c3aed 50%, #d946ef 100%);
            color: #fff;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        /* Glass Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        /* Header */
        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ec4899, #fbbf24);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .header .subtitle {
            font-size: 1.1rem;
            color: #fbbf24;
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .stat-card {
            text-align: center;
            padding: 20px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 400px 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        /* LINE OA Sidebar */
        .lineoa-sidebar {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.3rem;
            font-weight: 700;
            color: #fbbf24;
            margin-bottom: 15px;
        }

        .lineoa-item {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(236, 72, 153, 0.3);
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .lineoa-item:hover {
            border-color: #ec4899;
            background: rgba(236, 72, 153, 0.2);
        }

        .lineoa-item.active {
            border-color: #ec4899;
            background: rgba(236, 72, 153, 0.3);
            box-shadow: 0 0 20px rgba(236, 72, 153, 0.4);
        }

        .lineoa-name {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .lineoa-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-new {
            background: #10b981;
            color: #000;
        }

        .badge-old {
            background: #f59e0b;
            color: #000;
        }

        .lineoa-links {
            margin-top: 10px;
            display: flex;
            gap: 8px;
        }

        .link-btn {
            padding: 6px 12px;
            background: rgba(168, 85, 247, 0.3);
            border: 1px solid rgba(168, 85, 247, 0.5);
            border-radius: 8px;
            color: #fff;
            text-decoration: none;
            font-size: 0.85rem;
            transition: all 0.2s;
            display: inline-block;
        }

        .link-btn:hover {
            background: rgba(168, 85, 247, 0.5);
            border-color: #a855f7;
        }

        /* Brain Box Section */
        .brainbox-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .chat-box {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(168, 85, 247, 0.3);
            border-radius: 12px;
            padding: 20px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px;
            border-radius: 10px;
            line-height: 1.6;
        }

        .message-customer {
            background: rgba(59, 130, 246, 0.2);
            border-left: 3px solid #3b82f6;
        }

        .message-ai {
            background: rgba(168, 85, 247, 0.2);
            border-left: 3px solid #a855f7;
        }

        .input-group {
            display: flex;
            gap: 10px;
        }

        .text-input {
            flex: 1;
            padding: 12px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(168, 85, 247, 0.3);
            border-radius: 10px;
            color: #fff;
            font-size: 1rem;
            font-family: 'Space Grotesk', sans-serif;
        }

        .text-input:focus {
            outline: none;
            border-color: #a855f7;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #ec4899, #a855f7);
            border: none;
            border-radius: 10px;
            color: #fff;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1rem;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(236, 72, 153, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-copy {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        .btn-send {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }

        /* Credit Check Section */
        .credit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .credit-card {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(168, 85, 247, 0.3);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.2s;
        }

        .credit-card:hover {
            border-color: #a855f7;
            transform: translateY(-3px);
        }

        .credit-website {
            font-size: 1.1rem;
            font-weight: 700;
            color: #fbbf24;
            margin-bottom: 12px;
            text-align: center;
        }

        .credit-input-box {
            width: 100%;
            padding: 10px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(168, 85, 247, 0.3);
            border-radius: 8px;
            color: #fff;
            text-align: center;
            font-size: 1rem;
            font-family: 'Space Grotesk', sans-serif;
        }

        .credit-display {
            margin-top: 12px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: #10b981;
        }

        .credit-time {
            margin-top: 8px;
            text-align: center;
            font-size: 0.85rem;
            color: #9ca3af;
        }

        /* Action Bar */
        .action-bar {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        /* Quick Copy Buttons */
        .quick-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .quick-btn {
            padding: 8px 16px;
            background: rgba(236, 72, 153, 0.2);
            border: 1px solid rgba(236, 72, 153, 0.3);
            border-radius: 8px;
            color: #fff;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .quick-btn:hover {
            background: rgba(236, 72, 153, 0.4);
            border-color: #ec4899;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(168, 85, 247, 0.5);
            border-radius: 4px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üåå CS WORK AGENT</h1>
            <p class="subtitle">LINE OA Control Center + Brain Box AI</p>
        </div>

        <!-- Stats -->
        <div class="stats-grid">
            <div class="glass-card stat-card">
                <div class="stat-number" style="color: #fbbf24;">23</div>
                <div class="stat-label">‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
            </div>
            <div class="glass-card stat-card">
                <div class="stat-number" style="color: #10b981;">147</div>
                <div class="stat-label">‡∏ï‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
            </div>
            <div class="glass-card stat-card">
                <div class="stat-number" style="color: #3b82f6;">312</div>
                <div class="stat-label">‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
            </div>
            <div class="glass-card stat-card">
                <div class="stat-number" style="color: #ef4444;">5</div>
                <div class="stat-label">‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°</div>
            </div>
        </div>

        <!-- Main Layout -->
        <div class="main-layout">
            <!-- LINE OA Sidebar -->
            <div class="lineoa-sidebar">
                <div class="glass-card">
                    <div class="section-header">
                        <span>üí¨</span>
                        <span>LINE OA (13 ‡πÄ‡∏ß‡πá‡∏ö)</span>
                    </div>
                    <div id="lineoa-list"></div>
                </div>
            </div>

            <!-- Brain Box Section -->
            <div class="brainbox-section">
                <!-- Chat Display -->
                <div class="glass-card">
                    <div class="section-header">
                        <span>ü§ñ</span>
                        <span>Brain Box AI Assistant</span>
                        <span style="margin-left: auto; font-size: 0.9rem; font-weight: 400;" id="selected-website">
                            ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏≤‡∏Å LINE OA ‡∏Å‡πà‡∏≠‡∏ô
                        </span>
                    </div>
                    
                    <div class="chat-box" id="chat-box">
                        <div style="text-align: center; padding: 40px; opacity: 0.7;">
                            <p style="font-size: 1.2rem; margin-bottom: 10px;">üëã ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞!</p>
                            <p>1Ô∏è‚É£ ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏≤‡∏Å LINE OA</p>
                            <p>2Ô∏è‚É£ ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</p>
                            <p>3Ô∏è‚É£ ‡∏Å‡∏î "‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå"</p>
                            <p>4Ô∏è‚É£ Brain Box ‡∏à‡∏∞‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</p>
                            <p>5Ô∏è‚É£ ‡∏Å‡∏î "Copy ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö" ‡πÅ‡∏•‡πâ‡∏ß‡∏™‡πà‡∏á‡πÉ‡∏ô LINE</p>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="glass-card">
                    <div class="quick-actions">
                        <button class="quick-btn" onclick="quickPaste('‡∏Ñ‡∏∑‡∏ô‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏Ñ‡∏£‡∏±‡∏ö')">üîÑ ‡∏Ñ‡∏∑‡∏ô‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢</button>
                        <button class="quick-btn" onclick="quickPaste('‡∏ù‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á')">üí∞ ‡∏ù‡∏≤‡∏Å‡πÄ‡∏á‡∏¥‡∏ô</button>
                        <button class="quick-btn" onclick="quickPaste('‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ')">üí∏ ‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</button>
                        <button class="quick-btn" onclick="quickPaste('‡πÇ‡∏ö‡∏ô‡∏±‡∏™‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á')">üéÅ ‡πÇ‡∏ö‡∏ô‡∏±‡∏™</button>
                    </div>

                    <div class="input-group">
                        <input 
                            type="text" 
                            class="text-input" 
                            id="customer-input" 
                            placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà..."
                        >
                        <button class="btn" onclick="analyzMessage()">ü§ñ ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå</button>
                    </div>

                    <div class="action-bar">
                        <button class="btn btn-copy" onclick="copyAIResponse()">üìã Copy ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
                        <button class="btn btn-send" onclick="sendToLINE()">üì§ ‡∏™‡πà‡∏á‡πÉ‡∏ô LINE</button>
                        <button class="btn" onclick="clearChat()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏ä‡∏ó</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Credit Check (Old Backend Only) -->
        <div class="glass-card">
            <div class="section-header">
                <span>üí∞</span>
                <span>‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï 7 ‡πÄ‡∏ß‡πá‡∏ö (Old Backend ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)</span>
                <span style="margin-left: auto; font-size: 0.9rem; font-weight: 400; color: #fbbf24;">
                    ‡∏£‡∏≠‡∏ö 20:00-08:00
                </span>
            </div>

            <div class="credit-grid" id="credit-grid"></div>

            <div class="action-bar">
                <button class="btn" onclick="saveAllCredits()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="btn" onclick="exportReport()">üìä Export ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
            </div>
        </div>
    </div>

    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 13 ‡πÄ‡∏ß‡πá‡∏ö ‡∏û‡∏£‡πâ‡∏≠‡∏° LINE OA ‡πÅ‡∏•‡∏∞ Backend URLs
        const websites = {
            // New Backend (6 ‡πÄ‡∏ß‡πá‡∏ö) - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
            'LadyPink168': {
                backend: 'new',
                lineoa: 'https://manager.line.biz/account/XXXX', // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô URL ‡∏à‡∏£‡∏¥‡∏á
                dashboard: 'https://backend-ladypink168.com/admin', // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô URL ‡∏à‡∏£‡∏¥‡∏á
                wallet: false,
                color: '#ec4899'
            },
            'Osaka999JPN': {
                backend: 'new',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-osaka999.com/admin',
                wallet: true,
                color: '#f472b6'
            },
            'Hokkaido9999': {
                backend: 'new',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-hokkaido.com/admin',
                wallet: true,
                color: '#fb923c'
            },
            'Nuu789': {
                backend: 'new',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-nuu789.com/admin',
                wallet: true,
                color: '#fbbf24'
            },
            'PA00PLU002': {
                backend: 'new',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-pa00plu002.com/admin',
                wallet: true,
                color: '#a855f7'
            },
            'DD168PLAYER': {
                backend: 'new',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-dd168.com/admin',
                wallet: true,
                color: '#3b82f6'
            },

            // Old Backend (7 ‡πÄ‡∏ß‡πá‡∏ö) - ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô
            'boston66': {
                backend: 'old',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-boston66.com/admin',
                wallet: true,
                color: '#8b5cf6'
            },
            'sydney9999': {
                backend: 'old',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-sydney9999.com/admin',
                wallet: true,
                color: '#ec4899'
            },
            'maddix789': {
                backend: 'old',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-maddix789.com/admin',
                wallet: true,
                color: '#10b981'
            },
            'oslo66': {
                backend: 'old',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-oslo66.com/admin',
                wallet: true,
                color: '#3b82f6'
            },
            'zigar66': {
                backend: 'old',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-zigar66.com/admin',
                wallet: true,
                color: '#6b7280'
            },
            'maximum66': {
                backend: 'old',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-maximum66.com/admin',
                wallet: true,
                color: '#f59e0b'
            },
            'mung79': {
                backend: 'old',
                lineoa: 'https://manager.line.biz/account/XXXX',
                dashboard: 'https://backend-mung79.com/admin',
                wallet: true,
                color: '#a16207'
            }
        };

        // Brain Box Prompts
        const brainBoxPrompts = {
            'LadyPink168': {
                context: '‡πÄ‡∏ß‡πá‡∏ö: LadyPink168 | Backend: New | ‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏°‡∏µ Wallet',
                cashback: '‡∏Å‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ 06:00-23:30 ‡∏ô.',
                note: '‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ Wallet - ‡πÉ‡∏ä‡πâ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô'
            },
            'Osaka999JPN': {
                context: '‡πÄ‡∏ß‡πá‡∏ö: Osaka999JPN | Backend: New | ‚úÖ ‡∏°‡∏µ Wallet',
                cashback: '‡∏Å‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ 06:00-23:30 ‡∏ô.',
                note: '‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á Wallet ‡πÅ‡∏•‡∏∞‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£'
            },
            'boston66': {
                context: '‡πÄ‡∏ß‡πá‡∏ö: boston66 | Backend: Old | ‚úÖ ‡∏°‡∏µ Wallet',
                cashback: '‡∏Å‡∏î‡πÄ‡∏≠‡∏á + ‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏≠‡∏î‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (5% max 2,000‡∏ø)',
                note: '‡∏à‡∏≥‡∏Å‡∏±‡∏î 2,000 ‡∏ö‡∏≤‡∏ó/‡∏ß‡∏±‡∏ô'
            }
            // ... ‡πÄ‡∏û‡∏¥‡πà‡∏° prompt ‡∏ó‡∏∏‡∏Å‡πÄ‡∏ß‡πá‡∏ö
        };

        let selectedWebsite = null;
        let lastAIResponse = '';

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á LINE OA List
        function createLINEOAList() {
            const container = document.getElementById('lineoa-list');
            Object.entries(websites).forEach(([name, data]) => {
                const item = document.createElement('div');
                item.className = 'lineoa-item';
                item.onclick = () => selectWebsite(name, item);
                
                item.innerHTML = `
                    <div>
                        <div class="lineoa-name">${name}</div>
                        <div class="lineoa-links">
                            <a href="${data.lineoa}" target="_blank" class="link-btn" onclick="event.stopPropagation()">
                                üí¨ LINE OA
                            </a>
                            <a href="${data.dashboard}" target="_blank" class="link-btn" onclick="event.stopPropagation()">
                                üåê Backend
                            </a>
                        </div>
                    </div>
                    <span class="lineoa-badge badge-${data.backend}">
                        ${data.backend === 'new' ? 'NEW' : 'OLD'}
                    </span>
                `;
                
                container.appendChild(item);
            });
        }

        // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö
        function selectWebsite(name, element) {
            selectedWebsite = name;
            
            // Update UI
            document.querySelectorAll('.lineoa-item').forEach(item => {
                item.classList.remove('active');
            });
            element.classList.add('active');
            
            document.getElementById('selected-website').textContent = `üåê ${name}`;
            
            // Clear chat
            addSystemMessage(`‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ${name} ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡πà‡∏ß‡∏¢‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°!`);
        }

        // Quick Paste
        function quickPaste(text) {
            document.getElementById('customer-input').value = text;
        }

        // Add Message to Chat
        function addMessage(text, type) {
            const chatBox = document.getElementById('chat-box');
            const message = document.createElement('div');
            message.className = `message message-${type}`;
            message.innerHTML = text;
            chatBox.appendChild(message);
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        function addSystemMessage(text) {
            const chatBox = document.getElementById('chat-box');
            chatBox.innerHTML = `
                <div style="text-align: center; padding: 20px; opacity: 0.8;">
                    <p>${text}</p>
                </div>
            `;
        }

        // Analyze Message
        function analyzMessage() {
            const input = document.getElementById('customer-input');
            const customerMessage = input.value.trim();

            if (!customerMessage) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞');
                return;
            }

            if (!selectedWebsite) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏à‡∏≤‡∏Å LINE OA ‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞');
                return;
            }

            // Clear chat
            document.getElementById('chat-box').innerHTML = '';

            // Add customer message
            addMessage(`<strong>üë§ ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:</strong><br>${customerMessage}`, 'customer');

            // Show loading
            addMessage('ü§ñ Brain Box ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...', 'ai');

            // Simulate AI analysis
            setTimeout(() => {
                const websiteData = websites[selectedWebsite];
                const prompt = brainBoxPrompts[selectedWebsite] || brainBoxPrompts['Osaka999JPN'];
                
                // Remove loading
                document.getElementById('chat-box').lastChild.remove();

                // AI Response
                const aiResponse = generateAIResponse(customerMessage, selectedWebsite, websiteData, prompt);
                addMessage(aiResponse, 'ai');
                lastAIResponse = extractPlainText(aiResponse);

                input.value = '';
            }, 1500);
        }

        // Generate AI Response
        function generateAIResponse(customerMessage, website, data, prompt) {
            let response = `<strong>ü§ñ Brain Box ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå:</strong><br><br>`;
            
            response += `<div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px; margin-bottom: 10px;">`;
            response += `<strong>üåê ‡πÄ‡∏ß‡πá‡∏ö:</strong> ${website}<br>`;
            response += `<strong>üì¶ Backend:</strong> ${data.backend === 'new' ? 'New (‡∏Å‡∏î‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ)' : 'Old (‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏≠‡∏î)'}<br>`;
            response += `<strong>üí≥ Wallet:</strong> ${data.wallet ? '‚úÖ ‡∏°‡∏µ' : '‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ'}`;
            response += `</div>`;

            response += `<strong>üìã ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> <span style="color: #10b981;">Cashback</span><br>`;
            response += `<strong>üòä Mood:</strong> <span style="color: #3b82f6;">Friendly</span><br><br>`;

            response += `<strong>üí¨ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong><br>`;
            response += `<div style="background: rgba(236, 72, 153, 0.2); padding: 15px; border-radius: 10px; border: 2px solid rgba(236, 72, 153, 0.5); margin-top: 10px;">`;
            response += `‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡πà‡∏∞ üòä<br><br>`;
            
            if (data.backend === 'new') {
                response += `‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡πá‡∏ö ${website} ‡∏Ñ‡∏∑‡∏ô‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞<br>`;
                response += `‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤: 06:00 - 23:30 ‡∏ô. (‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô)<br><br>`;
                response += `üí° ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏î‡∏£‡∏±‡∏ö:<br>`;
                response += `1. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏ô‡∏π "‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô"<br>`;
                response += `2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "‡∏Ñ‡∏∑‡∏ô‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢"<br>`;
                response += `3. ‡∏Å‡∏î "‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏¢"<br><br>`;
                response += `‚ö†Ô∏è ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏î‡∏£‡∏±‡∏ö‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏¢‡∏≠‡∏î‡∏à‡∏∞‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏‡∏Ñ‡πà‡∏∞`;
            } else {
                response += `‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ß‡πá‡∏ö ${website} ‡∏Ñ‡∏∑‡∏ô‡∏¢‡∏≠‡∏î‡πÄ‡∏™‡∏µ‡∏¢ 5% (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2,000 ‡∏ö‡∏≤‡∏ó)<br><br>`;
                response += `üìå ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:<br>`;
                response += `1. ‡∏Ñ‡∏∏‡∏ì‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Å‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞<br>`;
                response += `2. ‡∏Å‡∏î‡∏£‡∏±‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏à‡πâ‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏≤‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏´‡πâ‡∏Ñ‡πà‡∏∞<br><br>`;
                response += `‚è±Ô∏è ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥: ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 15 ‡∏ô‡∏≤‡∏ó‡∏µ`;
            }

            if (!data.wallet) {
                response += `<br><br>‚ö†Ô∏è <strong>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö Wallet ‡∏ô‡∏∞‡∏Ñ‡∏∞ ‡∏ù‡∏≤‡∏Å-‡∏ñ‡∏≠‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô`;
            }

            response += `<br><br>‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ñ‡∏≤‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏ô‡∏∞‡∏Ñ‡∏∞ üíï`;
            response += `</div>`;

            return response;
        }

        // Extract Plain Text
        function extractPlainText(html) {
            const temp = document.createElement('div');
            temp.innerHTML = html;
            return temp.textContent || temp.innerText || '';
        }

        // Copy AI Response
        function copyAIResponse() {
            if (!lastAIResponse) {
                alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å Brain Box ‡∏Ñ‡πà‡∏∞');
                return;
            }

            const lines = lastAIResponse.split('\n');
            let cleanText = '';
            let inAnswer = false;

            lines.forEach(line => {
                if (line.includes('üí¨ ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:')) {
                    inAnswer = true;
                    return;
                }
                if (inAnswer && line.trim()) {
                    cleanText += line.trim() + '\n';
                }
            });

            navigator.clipboard.writeText(cleanText.trim()).then(() => {
                alert('‚úÖ Copy ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á‡πÉ‡∏ô LINE ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞');
            });
        }

        // Send to LINE (‡∏à‡∏≥‡∏•‡∏≠‡∏á)
        function sendToLINE() {
            if (!lastAIResponse) {
                alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏≤‡∏Å Brain Box ‡∏Ñ‡πà‡∏∞');
                return;
            }

            if (!selectedWebsite) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡πà‡∏∞');
                return;
            }

            alert(`üì§ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î LINE OA ‡∏Ç‡∏≠‡∏á ${selectedWebsite}...\n\n` +
                  '‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å Copy ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏î Ctrl+V ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏∞');

            // ‡πÄ‡∏õ‡∏¥‡∏î LINE OA
            window.open(websites[selectedWebsite].lineoa, '_blank');
        }

        // Clear Chat
        function clearChat() {
            addSystemMessage('‡πÄ‡∏Ñ‡∏•‡∏µ‡∏¢‡∏£‡πå‡πÅ‡∏ä‡∏ó‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏∞ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà!');
            lastAIResponse = '';
        }

        // Credit Functions (Old Backend Only)
        function createCreditCards() {
            const container = document.getElementById('credit-grid');
            
            Object.entries(websites).forEach(([name, data]) => {
                // ‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Old Backend
                if (data.backend !== 'old') return;

                const card = document.createElement('div');
                card.className = 'credit-card';
                card.innerHTML = `
                    <div class="credit-website">${name}</div>
                    <input type="text" class="credit-input-box" id="credit-${name}" placeholder="‡∏Å‡∏£‡∏≠‡∏Å (K/M)">
                    <div class="credit-display" id="display-${name}">-</div>
                    <div class="credit-time" id="time-${name}">-</div>
                `;
                container.appendChild(card);

                // Event listener
                const input = document.getElementById(`credit-${name}`);
                input.addEventListener('blur', () => updateCredit(name));
            });
        }

        function parseCredit(value) {
            const str = value.toUpperCase().trim();
            if (str.includes('M')) {
                return parseFloat(str.replace('M', '')) * 1000000;
            } else if (str.includes('K')) {
                return parseFloat(str.replace('K', '')) * 1000;
            }
            return parseFloat(str) || 0;
        }

        function updateCredit(website) {
            const inputEl = document.getElementById(`credit-${website}`);
            const displayEl = document.getElementById(`display-${website}`);
            const timeEl = document.getElementById(`time-${website}`);

            const value = inputEl.value;
            if (!value) return;

            const credit = parseCredit(value);
            displayEl.textContent = `‡∏ø ${credit.toLocaleString('th-TH', {minimumFractionDigits: 2})}`;

            const now = new Date();
            timeEl.textContent = `‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó: ${now.toLocaleTimeString('th-TH', {
                hour: '2-digit',
                minute: '2-digit'
            })}`;

            localStorage.setItem(`credit_${website}`, credit);
            localStorage.setItem(`time_${website}`, now.toISOString());
        }

        function saveAllCredits() {
            let saved = 0;
            Object.entries(websites).forEach(([name, data]) => {
                if (data.backend !== 'old') return;
                const inputEl = document.getElementById(`credit-${name}`);
                if (inputEl.value) {
                    updateCredit(name);
                    saved++;
                }
            });
            alert(`‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï ${saved} ‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!`);
        }

        function exportReport() {
            const report = {
                date: new Date().toLocaleDateString('th-TH'),
                time: new Date().toLocaleTimeString('th-TH'),
                credits: {}
            };

            Object.entries(websites).forEach(([name, data]) => {
                if (data.backend !== 'old') return;
                const displayEl = document.getElementById(`display-${name}`);
                report.credits[name] = displayEl.textContent;
            });

            const dataStr = JSON.stringify(report, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `credit-report-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // Enter key support
        document.getElementById('customer-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                analyzMessage();
            }
        });

        // Initialize
        createLINEOAList();
        createCreditCards();
    </script>
</body>
</html>
